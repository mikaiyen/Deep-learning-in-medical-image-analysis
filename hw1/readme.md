
---

# Homework 1: USPS 手寫數字辨識

本作業目標是利用提供的美國郵政服務 (U.S. Postal Service) 手寫數字資料集，透過深度學習模型來進行數字 (0～9) 的分類預測。

## 1. 專案簡介

- **資料來源**  
  本資料集來自 Le Cun 等人在 1990 年所提出的 USPS 手寫數字影像，原始掃描圖像為二值、大小與方向不一。經過預處理後，已被轉正並縮放為 16×16 的灰階圖 (總共 256 個像素)。

- **任務目標**  
  藉由訓練一個深度學習分類器，對給定的 16×16 手寫數字影像進行辨識，預測其對應的數字類別 (0～9)。

- **提供的檔案**  
  1. `zip.train.csv`：訓練資料，每一列包含「影像編號」、「真實數字標籤(0～9)」以及 256 個像素值。  
  2. `zip.test.csv`：測試資料，每一列包含「影像編號」以及 256 個像素值 (不含標籤，用於最終預測與模型表現評估)。  

## 2. 環境與需求

- **程式語言**：Python 3.x  
- **主要函式庫**  
  - PyTorch (用於構建與訓練神經網路)  
  - NumPy / pandas (資料處理)  
  - Matplotlib (繪圖)  
- **硬體需求**  
  - 推薦使用 GPU（例如 CUDA-enabled GPU），以加速模型訓練過程。

## 3. 資料前處理與探索  

1. **資料大小與分佈 (Q3)**  
   - 統計每個數字 (0～9) 在訓練集中的數量，並呈現出每個類別的資料筆數。

2. **影像可視化 (Q4)**  
   - 隨機選擇 10 張訓練影像，將其 16×16 灰階值轉為影像並繪製成圖，以確認資料品質與內容。

## 4. 模型設計

1. **模型架構**  
   - 共有三層全連接 (Fully-Connected) + Batch Normalization + ReLU Activation：
     1. Linear (in=256, out=256) + BatchNorm + ReLU  
     2. Linear (in=256, out=128) + BatchNorm + ReLU  
     3. Linear (in=128, out=64) + BatchNorm + ReLU  
     - Dropout(0.5)  
     - 最後輸出層 (輸出 10 個類別)
   
2. **參數量**  
   - 此模型總參數約 108,490。  
   - 可透過 `model.parameters()` 計算並加總得到確切數值。

3. **訓練設定**  
   - 損失函數 (Loss function)：CrossEntropyLoss  
   - 最適化方法 (Optimizer)：如 Adam 或 SGD  
   - Epochs：根據報告，使用 50 epochs 以提交最終預測成果
   - Batch size：可根據 GPU 記憶體與訓練需求調整，例如 64 或 128。  

4. **GPU 加速**  
   - 在程式中判斷裝置是否有 CUDA，若有則將模型與資料轉移至 GPU。

## 5. 訓練流程與使用方式

1. **準備資料**  
   - 將 `zip.train.csv` 與 `zip.test.csv` 放置於專案目錄下。  

2. **安裝相依套件**  
   ```bash
   pip install torch torchvision torchaudio
   pip install numpy pandas matplotlib
   ```

3. **執行程式**  
   - 在 Jupyter Notebook 中直接執行每個 cell 進行訓練、預測與視覺化。

4. **產生預測結果**  
   - 模型訓練完畢後，讀取 `zip.test.csv`，輸出每張測試影像的預測類別 (0～9)。  

## 6. 結果與分析

1. **分類準確度 (Accuracy)**  
   - 以訓練集或驗證集 (若有切分) 的準確度觀察模型的擬合情況。  
   - 使用測試集計算最終預測的準確度。

2. **訓練過程觀察 (Q5b)**  
   - 繪製 Epoch 數量 vs. 錯誤率 (Misclassification Rate) 的關係圖。  
   - 依照模型設計與超參數的不同，可觀察收斂速度與最終表現。

3. **再現性 (Reproductivity)**  
   - 在相同亂數種子與相同訓練次數下，可期望得到相近的結果。但由於 GPU 與隨機性設定，有時仍會有些微差異。

4. **訓練困難 (報告點出)**  
   - 使用 GPU 訓練可能遇到環境設置、顯示卡記憶體不足等問題，需確保相關套件版本相容並正確安裝。

## 7. 心得與未來改進

- **心得**  
  - 本次作業透過全連接層 (MLP) 建構手寫數字辨識模型，成功達到良好準確度。  
  - 練習了對影像資料的基本視覺化、模型建立與評估流程。

- **可改進方向**  
  - 可嘗試更深或不同結構，如 Convolutional Neural Network (CNN)，可能提升準確度。  
  - 調整不同的超參數，如學習率 (learning rate)、Batch size 或使用其他正規化方法。
